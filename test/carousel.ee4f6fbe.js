const f=(u,t=1e4)=>(u=parseFloat(u+"")||0,Math.round((u+Number.EPSILON)*t)/t),q=function(u,t){return!(!u||u===document.body||t&&u===t)&&(function(e){if(!(e&&e instanceof Element&&e.offsetParent))return!1;const i=e.scrollHeight>e.clientHeight,n=window.getComputedStyle(e).overflowY,s=n.indexOf("hidden")!==-1,o=n.indexOf("visible")!==-1;return i&&!s&&!o}(u)?u:q(u.parentElement,t))},G=function(u){var t=new DOMParser().parseFromString(u,"text/html").body;if(t.childElementCount>1){for(var e=document.createElement("div");t.firstChild;)e.appendChild(t.firstChild);return e}return t.firstChild},U=u=>`${u||""}`.split(" ").filter(t=>!!t),k=(u,t,e)=>{U(t).forEach(i=>{u&&u.classList.toggle(i,e||!1)})};class A{constructor(t){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=t,this.pageX=t.pageX,this.pageY=t.pageY,this.clientX=t.clientX,this.clientY=t.clientY,this.id=self.Touch&&t instanceof Touch?t.identifier:-1,this.time=Date.now()}}const D={passive:!1};class rt{constructor(t,{start:e=()=>!0,move:i=()=>{},end:n=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=t,this.startCallback=e,this.moveCallback=i,this.endCallback=n;for(const s of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[s]=this[s].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,D),this.element.addEventListener("touchstart",this.onTouchStart,D),this.element.addEventListener("touchmove",this.onMove,D),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(t){if(!t.buttons||t.button!==0)return;const e=new A(t);this.currentPointers.some(i=>i.id===e.id)||this.triggerPointerStart(e,t)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(t){for(const e of Array.from(t.changedTouches||[]))this.triggerPointerStart(new A(e),t);window.addEventListener("blur",this.onWindowBlur)}onMove(t){const e=this.currentPointers.slice(),i="changedTouches"in t?Array.from(t.changedTouches||[]).map(s=>new A(s)):[new A(t)],n=[];for(const s of i){const o=this.currentPointers.findIndex(a=>a.id===s.id);o<0||(n.push(s),this.currentPointers[o]=s)}n.length&&this.moveCallback(t,this.currentPointers.slice(),e)}onPointerEnd(t){t.buttons>0&&t.button!==0||(this.triggerPointerEnd(t,new A(t)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(t){for(const e of Array.from(t.changedTouches||[]))this.triggerPointerEnd(t,new A(e))}triggerPointerStart(t,e){return!!this.startCallback(e,t,this.currentPointers.slice())&&(this.currentPointers.push(t),this.startPointers.push(t),!0)}triggerPointerEnd(t,e){const i=this.currentPointers.findIndex(n=>n.id===e.id);i<0||(this.currentPointers.splice(i,1),this.startPointers.splice(i,1),this.endCallback(t,e,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const t=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY}),t,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,D),this.element.removeEventListener("touchstart",this.onTouchStart,D),this.element.removeEventListener("touchmove",this.onMove,D),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function J(u,t){return t?Math.sqrt(Math.pow(t.clientX-u.clientX,2)+Math.pow(t.clientY-u.clientY,2)):0}function Q(u,t){return t?{clientX:(u.clientX+t.clientX)/2,clientY:(u.clientY+t.clientY)/2}:u}const _=u=>typeof u=="object"&&u!==null&&u.constructor===Object&&Object.prototype.toString.call(u)==="[object Object]",B=(u,...t)=>{const e=t.length;for(let i=0;i<e;i++){const n=t[i]||{};Object.entries(n).forEach(([s,o])=>{const a=Array.isArray(o)?[]:{};u[s]||Object.assign(u,{[s]:a}),_(o)?Object.assign(u[s],B(a,o)):Array.isArray(o)?Object.assign(u,{[s]:[...o]}):Object.assign(u,{[s]:o})})}return u},$=function(u,t){return u.split(".").reduce((e,i)=>typeof e=="object"?e[i]:void 0,t)};class X{constructor(t={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(t);for(const e of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))e.startsWith("on")&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}setOptions(t){this.options=t?B({},this.constructor.defaults,t):{};for(const[e,i]of Object.entries(this.option("on")||{}))this.on(e,i)}option(t,...e){let i=$(t,this.options);return i&&typeof i=="function"&&(i=i.call(this,this,...e)),i}optionFor(t,e,i,...n){let s=$(e,t);var o;typeof(o=s)!="string"||isNaN(o)||isNaN(parseFloat(o))||(s=parseFloat(s)),s==="true"&&(s=!0),s==="false"&&(s=!1),s&&typeof s=="function"&&(s=s.call(this,this,t,...n));let a=$(e,this.options);return a&&typeof a=="function"?s=a.call(this,this,t,...n,s):s===void 0&&(s=a),s===void 0?i:s}cn(t){const e=this.options.classes;return e&&e[t]||""}localize(t,e=[]){t=String(t).replace(/\{\{(\w+).?(\w+)?\}\}/g,(i,n,s)=>{let o="";return s?o=this.option(`${n[0]+n.toLowerCase().substring(1)}.l10n.${s}`):n&&(o=this.option(`l10n.${n}`)),o||(o=i),o});for(let i=0;i<e.length;i++)t=t.split(e[i][0]).join(e[i][1]);return t=t.replace(/\{\{(.*?)\}\}/g,(i,n)=>n)}on(t,e){let i=[];typeof t=="string"?i=t.split(" "):Array.isArray(t)&&(i=t),this.events||(this.events=new Map),i.forEach(n=>{let s=this.events.get(n);s||(this.events.set(n,[]),s=[]),s.includes(e)||s.push(e),this.events.set(n,s)})}off(t,e){let i=[];typeof t=="string"?i=t.split(" "):Array.isArray(t)&&(i=t),i.forEach(n=>{const s=this.events.get(n);if(Array.isArray(s)){const o=s.indexOf(e);o>-1&&s.splice(o,1)}})}emit(t,...e){[...this.events.get(t)||[]].forEach(i=>i(this,...e)),t!=="*"&&this.emit("*",t,...e)}}Object.defineProperty(X,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.19"}),Object.defineProperty(X,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class it extends X{constructor(t={}){super(t),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(t={}){const e=new Map;for(const[i,n]of Object.entries(t)){const s=this.option(i),o=this.plugins[i];o||s===!1?o&&s===!1&&(o.detach(),delete this.plugins[i]):e.set(i,new n(this,s||{}))}for(const[i,n]of e)this.plugins[i]=n,n.attach();this.emit("attachPlugins")}detachPlugins(t){t=t||Object.keys(this.plugins);for(const e of t){const i=this.plugins[e];i&&i.detach(),delete this.plugins[e]}return this.emit("detachPlugins"),this}}var P;(function(u){u[u.Init=0]="Init",u[u.Error=1]="Error",u[u.Ready=2]="Ready",u[u.Panning=3]="Panning",u[u.Mousemove=4]="Mousemove",u[u.Destroy=5]="Destroy"})(P||(P={}));const z=["a","b","c","d","e","f"],lt={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:{PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"}},st='<div class="f-spinner"><svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20"></circle><circle cx="25" cy="25" r="20"></circle></svg></div>',H=u=>u&&u!==null&&u instanceof Element&&"nodeType"in u,E=(u,t)=>{u&&U(t).forEach(e=>{u.classList.remove(e)})},T=(u,t)=>{u&&U(t).forEach(e=>{u.classList.add(e)})},N={a:1,b:0,c:0,d:1,e:0,f:0};let Z=null,V=null;class j extends it{get isTouchDevice(){return V===null&&(V=window.matchMedia("(hover: none)").matches),V}get isMobile(){return Z===null&&(Z=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Z}get panMode(){return this.options.panMode!=="mousemove"||this.isTouchDevice?"drag":"mousemove"}get panOnlyZoomed(){const t=this.options.panOnlyZoomed;return t==="auto"?this.isTouchDevice:t}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:t,b:e}=this.current;return Math.sqrt(t*t+e*e)||1}get targetScale(){const{a:t,b:e}=this.target;return Math.sqrt(t*t+e*e)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:t}=this;return t.fullWidth/t.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:t,contentRect:e}=this,i=Math.max(t.height/e.fitHeight,t.width/e.fitWidth)||1;return Math.min(this.fullScale,i)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const t=this.content;return!!(t&&t instanceof HTMLImageElement)&&!t.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const t of z){const e=t=="e"||t==="f"?.001:1e-5;if(Math.abs(this.target[t]-this.current[t])>e)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(t,e={},i={}){var n;if(super(e),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:P.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},N)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},N)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!t)throw new Error("Container Element Not Found");this.container=t,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},j.Plugins),i)),this.emit("init");const s=this.content;if(s.addEventListener("load",this.onLoad),s.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){t.classList.add(this.cn("isLoading"));const o=G(st);!t.contains(s)||s.parentElement instanceof HTMLPictureElement?this.spinner=t.appendChild(o):this.spinner=((n=s.parentElement)===null||n===void 0?void 0:n.insertBefore(o,s))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:t}=this,e=this.cn("content");let i=this.option("content")||t.querySelector(`.${e}`);if(i||(i=t.querySelector("img,picture")||t.firstElementChild,i&&T(i,e)),i instanceof HTMLPictureElement&&(i=i.querySelector("img")),!i)throw new Error("No content found");this.content=i}onLoad(){this.spinner&&(this.spinner.remove(),this.spinner=null),this.option("spinner")&&this.container.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),this.state===P.Init?this.enable():this.updateMetrics()}onError(){this.state!==P.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=P.Error,this.emit("error"))}attachObserver(){var t;const e=()=>Math.abs(this.containerRect.width-this.container.getBoundingClientRect().width)>.1||Math.abs(this.containerRect.height-this.container.getBoundingClientRect().height)>.1;this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(e()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{e()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(t=this.resizeObserver)===null||t===void 0||t.observe(this.container)}detachObserver(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()}attachEvents(){const{container:t}=this;t.addEventListener("click",this.onClick,{passive:!1,capture:!1}),t.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new rt(t,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener("mousemove",this.onMouseMove)}detachEvents(){var t;const{container:e}=this;e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),e.removeEventListener("wheel",this.onWheel,{passive:!1}),(t=this.pointerTracker)===null||t===void 0||t.stop(),this.pointerTracker=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){const t=this.friction;this.setTargetForce();const e=this.option("maxVelocity");for(const i of z)t?(this.velocity[i]*=1-t,e&&!this.isScaling&&(this.velocity[i]=Math.max(Math.min(this.velocity[i],e),-1*e)),this.current[i]+=this.velocity[i]):this.current[i]=this.target[i];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const t of z)t==="e"&&this.isBouncingX||t==="f"&&this.isBouncingY||(this.velocity[t]=(1/(1-this.friction)-1)*(this.target[t]-this.current[t]))}checkBounds(t=0,e=0){const{current:i}=this,n=i.e+t,s=i.f+e,o=this.getBounds(),{x:a,y:r}=o,l=a.min,d=a.max,p=r.min,h=r.max;let c=0,g=0;return l!==1/0&&n<l?c=l-n:d!==1/0&&n>d&&(c=d-n),p!==1/0&&s<p?g=p-s:h!==1/0&&s>h&&(g=h-s),Math.abs(c)<.001&&(c=0),Math.abs(g)<.001&&(g=0),Object.assign(Object.assign({},o),{xDiff:c,yDiff:g,inBounds:!c&&!g})}clampTargetBounds(){const{target:t}=this,{x:e,y:i}=this.getBounds();e.min!==1/0&&(t.e=Math.max(t.e,e.min)),e.max!==1/0&&(t.e=Math.min(t.e,e.max)),i.min!==1/0&&(t.f=Math.max(t.f,i.min)),i.max!==1/0&&(t.f=Math.min(t.f,i.max))}calculateContentDim(t=this.current){const{content:e,contentRect:i}=this,{fitWidth:n,fitHeight:s,fullWidth:o,fullHeight:a}=i;let r=o,l=a;if(this.option("zoom")||this.angle!==0){const d=!(e instanceof HTMLImageElement)&&(window.getComputedStyle(e).maxWidth==="none"||window.getComputedStyle(e).maxHeight==="none"),p=d?o:n,h=d?a:s,c=this.getMatrix(t),g=new DOMPoint(0,0).matrixTransform(c),b=new DOMPoint(0+p,0).matrixTransform(c),m=new DOMPoint(0+p,0+h).matrixTransform(c),y=new DOMPoint(0,0+h).matrixTransform(c),w=Math.abs(m.x-g.x),v=Math.abs(m.y-g.y),M=Math.abs(y.x-b.x),R=Math.abs(y.y-b.y);r=Math.max(w,M),l=Math.max(v,R)}return{contentWidth:r,contentHeight:l}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode==="mousemove"||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:t}=this,{x:e,y:i,xDiff:n,yDiff:s}=this.checkBounds(),o=this.option("maxVelocity");let a=this.velocity.e,r=this.velocity.f;n!==0?(this.isBouncingX=!0,n*a<=0?a+=.14*n:(a=.14*n,e.min!==1/0&&(this.target.e=Math.max(t.e,e.min)),e.max!==1/0&&(this.target.e=Math.min(t.e,e.max))),o&&(a=Math.max(Math.min(a,o),-1*o))):this.isBouncingX=!1,s!==0?(this.isBouncingY=!0,s*r<=0?r+=.14*s:(r=.14*s,i.min!==1/0&&(this.target.f=Math.max(t.f,i.min)),i.max!==1/0&&(this.target.f=Math.min(t.f,i.max))),o&&(r=Math.max(Math.min(r,o),-1*o))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=a),this.isBouncingY&&(this.velocity.f=r)}enable(){const{content:t}=this,e=new DOMMatrixReadOnly(window.getComputedStyle(t).transform);for(const i of z)this.current[i]=this.target[i]=e[i];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=P.Ready,this.emit("ready")}onClick(t){var e;this.isDragging&&((e=this.pointerTracker)===null||e===void 0||e.clear(),this.trackingPoints=[],this.startDecelAnim());const i=t.target;if(!i||t.defaultPrevented)return;if(i&&i.hasAttribute("disabled"))return t.preventDefault(),void t.stopPropagation();if((()=>{const h=window.getSelection();return h&&h.type==="Range"})()&&!i.closest("button"))return;const n=i.closest("[data-panzoom-action]"),s=i.closest("[data-panzoom-change]"),o=n||s,a=o&&H(o)?o.dataset:null;if(a){const h=a.panzoomChange,c=a.panzoomAction;if((h||c)&&t.preventDefault(),h){let g={};try{g=JSON.parse(h)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(g)}if(c)return void(this[c]&&this[c]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return t.preventDefault(),void t.stopPropagation();const r=this.content.getBoundingClientRect();if(this.dragStart.time&&!this.canZoomOut()&&(Math.abs(r.x-this.dragStart.x)>2||Math.abs(r.y-this.dragStart.y)>2))return;this.dragStart.time=0;const l=h=>{this.option("zoom")&&h&&typeof h=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(h)&&typeof this[h]=="function"&&(t.preventDefault(),this[h]({event:t}))},d=this.option("click",t),p=this.option("dblClick",t);p?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",t),!t.defaultPrevented&&d&&l(d)):(this.emit("dblClick",t),t.defaultPrevented||l(p)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",t),!t.defaultPrevented&&d&&l(d))}addTrackingPoint(t){const e=this.trackingPoints.filter(i=>i.time>Date.now()-100);e.push(t),this.trackingPoints=e}onPointerDown(t,e,i){var n;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const s=this.content.getBoundingClientRect();if(this.dragStart={x:s.x,y:s.y,top:s.top,left:s.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode==="mousemove"&&this.targetScale>1)return t.preventDefault(),t.stopPropagation(),!1;if(!i.length){const o=t.composedPath()[0];if(["A","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(o.nodeName)||o.closest("[contenteditable]")||o.closest("[data-selectable]")||o.closest("[data-draggable]")||o.closest("[data-panzoom-change]")||o.closest("[data-panzoom-action]"))return!1;(n=window.getSelection())===null||n===void 0||n.removeAllRanges()}if(t.type==="mousedown")t.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(e),this.emit("touchStart",t)),!0}onPointerMove(t,e,i){if(this.option("touch",t)===!1||!this.isDragging||e.length<2&&this.panOnlyZoomed&&f(this.targetScale)<=f(this.minScale)||(this.emit("touchMove",t),t.defaultPrevented))return;this.addTrackingPoint(e[0]);const{content:n}=this,s=Q(i[0],i[1]),o=Q(e[0],e[1]);let a=0,r=0;if(e.length>1){const v=n.getBoundingClientRect();a=s.clientX-v.left-.5*v.width,r=s.clientY-v.top-.5*v.height}const l=J(i[0],i[1]),d=J(e[0],e[1]);let p=l?d/l:1,h=o.clientX-s.clientX,c=o.clientY-s.clientY;this.dragOffset.x+=h,this.dragOffset.y+=c,this.dragOffset.time=Date.now()-this.dragStart.time;let g=f(this.targetScale)===f(this.minScale)&&this.option("lockAxis");if(g&&!this.lockedAxis)if(g==="xy"||g==="y"||t.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void t.preventDefault();const v=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=v>45&&v<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,h=0,c=0}else this.lockedAxis=g;if(q(t.target,this.content)&&(g="x",this.dragOffset.y=0),g&&g!=="xy"&&this.lockedAxis!==g&&f(this.targetScale)===f(this.minScale))return;t.cancelable&&t.preventDefault(),this.container.classList.add(this.cn("isDragging"));const b=this.checkBounds(h,c);this.option("rubberband")?(this.isInfinite!=="x"&&(b.xDiff>0&&h<0||b.xDiff<0&&h>0)&&(h*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*b.xDiff))),this.isInfinite!=="y"&&(b.yDiff>0&&c<0||b.yDiff<0&&c>0)&&(c*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*b.yDiff)))):(b.xDiff&&(h=0),b.yDiff&&(c=0));const m=this.targetScale,y=this.minScale,w=this.maxScale;m<.5*y&&(p=Math.max(p,y)),m>1.5*w&&(p=Math.min(p,w)),this.lockedAxis==="y"&&f(m)===f(y)&&(h=0),this.lockedAxis==="x"&&f(m)===f(y)&&(c=0),this.applyChange({originX:a,originY:r,panX:h,panY:c,scale:p,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(t,e,i){if(i.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(e),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),q(t.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",t),this.isDragging=!1,this.lockedAxis=!1,this.state!==P.Destroy&&(t.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var t;const e=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const v of z)this.velocity[v]=0;this.target.e=this.current.e,this.target.f=this.current.f,E(this.container,"is-scaling"),E(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:i}=this,n=i[0],s=i[i.length-1];let o=0,a=0,r=0;s&&n&&(o=s.clientX-n.clientX,a=s.clientY-n.clientY,r=s.time-n.time);const l=((t=window.visualViewport)===null||t===void 0?void 0:t.scale)||1;l!==1&&(o*=l,a*=l);let d=0,p=0,h=0,c=0,g=this.option("decelFriction");const b=this.targetScale;if(r>0){h=Math.abs(o)>3?o/(r/30):0,c=Math.abs(a)>3?a/(r/30):0;const v=this.option("maxVelocity");v&&(h=Math.max(Math.min(h,v),-1*v),c=Math.max(Math.min(c,v),-1*v))}h&&(d=h/(1/(1-g)-1)),c&&(p=c/(1/(1-g)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&f(b)===this.minScale)&&(d=h=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&f(b)===this.minScale)&&(p=c=0);const m=this.dragOffset.x,y=this.dragOffset.y,w=this.option("dragMinThreshold")||0;Math.abs(m)<w&&Math.abs(y)<w&&(d=p=0,h=c=0),(b<this.minScale-1e-5||b>this.maxScale+1e-5||e&&!d&&!p)&&(g=.35),this.applyChange({panX:d,panY:p,friction:g}),this.emit("decel",h,c,m,y)}onWheel(t){var e=[-t.deltaX||0,-t.deltaY||0,-t.detail||0].reduce(function(s,o){return Math.abs(o)>Math.abs(s)?o:s});const i=Math.max(-1,Math.min(1,e));if(this.emit("wheel",t,i),this.panMode==="mousemove"||t.defaultPrevented)return;const n=this.option("wheel");n==="pan"?(t.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-t.deltaX,panY:2*-t.deltaY,bounce:!1})):n==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(t)}onMouseMove(t){this.panWithMouse(t)}onKeydown(t){t.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:t,target:e,content:i,contentRect:n}=this,s=Object.assign({},N);for(const m of z){const y=m=="e"||m==="f"?1e3:1e5;s[m]=f(t[m],y),Math.abs(e[m]-t[m])<(m=="e"||m==="f"?.51:.001)&&(t[m]=e[m])}let{a:o,b:a,c:r,d:l,e:d,f:p}=s,h=`matrix(${o}, ${a}, ${r}, ${l}, ${d}, ${p})`,c=i.parentElement instanceof HTMLPictureElement?i.parentElement:i;if(this.option("transformParent")&&(c=c.parentElement||c),c.style.transform===h)return;c.style.transform=h;const{contentWidth:g,contentHeight:b}=this.calculateContentDim();n.width=g,n.height=b,this.emit("afterTransform")}updateMetrics(t=!1){var e;if(!this||this.state===P.Destroy||this.isContentLoading)return;const i=Math.max(1,((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1),{container:n,content:s}=this,o=s instanceof HTMLImageElement,a=n.getBoundingClientRect(),r=getComputedStyle(this.container);let l=a.width*i,d=a.height*i;const p=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),h=l-(parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)),c=d-p;this.containerRect={width:l,height:d,innerWidth:h,innerHeight:c};let g=this.option("width")||"auto",b=this.option("height")||"auto";g==="auto"&&(g=parseFloat(s.dataset.width||"")||(x=>{let O=0;return O=x instanceof HTMLImageElement?x.naturalWidth:x instanceof SVGElement?x.width.baseVal.value:Math.max(x.offsetWidth,x.scrollWidth),O||0})(s)),b==="auto"&&(b=parseFloat(s.dataset.height||"")||(x=>{let O=0;return O=x instanceof HTMLImageElement?x.naturalHeight:x instanceof SVGElement?x.height.baseVal.value:Math.max(x.offsetHeight,x.scrollHeight),O||0})(s));let m=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;this.option("transformParent")&&(m=m.parentElement||m);const y=m.getAttribute("style")||"";m.style.setProperty("transform","none","important"),o&&(m.style.width="",m.style.height=""),m.offsetHeight;const w=s.getBoundingClientRect();let v=w.width*i,M=w.height*i,R=0,L=0;o&&(Math.abs(g-v)>1||Math.abs(b-M)>1)&&({width:v,height:M,top:R,left:L}=((x,O,F,I)=>{const Y=F/I;return Y>x/O?(F=x,I=x/Y):(F=O*Y,I=O),{width:F,height:I,top:.5*(O-I),left:.5*(x-F)}})(v,M,g,b)),this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:w.top-a.top+R,bottom:a.bottom-w.bottom+R,left:w.left-a.left+L,right:a.right-w.right+L,fitWidth:v,fitHeight:M,width:v,height:M,fullWidth:g,fullHeight:b}),m.style.cssText=y,o&&(m.style.width=`${v}px`,m.style.height=`${M}px`),this.setTransform(),t!==!0&&this.emit("refresh"),this.ignoreBounds||(f(this.targetScale)<f(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===P.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}getBounds(){const t=this.option("bounds");if(t!=="auto")return t;const{contentWidth:e,contentHeight:i}=this.calculateContentDim(this.target);let n=0,s=0,o=0,a=0;const r=this.option("infinite");if(r===!0||this.lockedAxis&&r===this.lockedAxis)n=-1/0,o=1/0,s=-1/0,a=1/0;else{let{containerRect:l,contentRect:d}=this,p=f(this.contentRect.fitWidth*this.targetScale,1e3),h=f(this.contentRect.fitHeight*this.targetScale,1e3),{innerWidth:c,innerHeight:g}=l;if(this.containerRect.width===p&&(c=l.width),this.containerRect.width===h&&(g=l.height),e>c){o=.5*(e-c),n=-1*o;let b=.5*(d.right-d.left);n+=b,o+=b}if(this.contentRect.fitWidth>c&&e<c&&(n-=.5*(this.contentRect.fitWidth-c),o-=.5*(this.contentRect.fitWidth-c)),i>g){a=.5*(i-g),s=-1*a;let b=.5*(d.bottom-d.top);s+=b,a+=b}this.contentRect.fitHeight>g&&i<g&&(n-=.5*(this.contentRect.fitHeight-g),o-=.5*(this.contentRect.fitHeight-g))}return{x:{min:n,max:o},y:{min:s,max:a}}}updateControls(){const t=this,e=t.container,{panMode:i,contentRect:n,fullScale:s,targetScale:o,coverScale:a,maxScale:r,minScale:l}=t;let d={toggleMax:o-l<.5*(r-l)?r:l,toggleCover:o-l<.5*(a-l)?a:l,toggleZoom:o-l<.5*(s-l)?s:l}[t.option("click")||""]||l,p=t.canZoomIn(),h=t.canZoomOut(),c=h&&i==="drag";f(o)<f(l)&&!this.panOnlyZoomed&&(c=!0),(f(n.width,1)>f(n.fitWidth,1)||f(n.height,1)>f(n.fitHeight,1))&&(c=!0),f(n.width*o,1)<f(n.fitWidth,1)&&(c=!1),i==="mousemove"&&(c=!1);let g=p&&f(d)>f(o),b=!g&&!c&&h&&f(d)<f(o);k(e,this.cn("canZoomIn"),g),k(e,this.cn("canZoomOut"),b),k(e,this.cn("isDraggable"),c);for(const m of e.querySelectorAll('[data-panzoom-action="zoomIn"]'))p?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="zoomOut"]'))h?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){p||h?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const y=m.querySelector("g");y&&(y.style.display=p?"":"none")}}panTo({x:t=this.target.e,y:e=this.target.f,scale:i=this.targetScale,friction:n=this.option("friction"),angle:s=0,originX:o=0,originY:a=0,flipX:r=!1,flipY:l=!1,ignoreBounds:d=!1}){this.state!==P.Destroy&&this.applyChange({panX:t-this.target.e,panY:e-this.target.f,scale:i/this.targetScale,angle:s,originX:o,originY:a,friction:n,flipX:r,flipY:l,ignoreBounds:d})}applyChange({panX:t=0,panY:e=0,scale:i=1,angle:n=0,originX:s=-this.current.e,originY:o=-this.current.f,friction:a=this.option("friction"),flipX:r=!1,flipY:l=!1,ignoreBounds:d=!1,bounce:p=this.option("bounce")}){if(this.state===P.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=a||0,this.ignoreBounds=d;const{current:h}=this,c=h.e,g=h.f,b=this.getMatrix(this.target);let m=new DOMMatrix().translate(c,g).translate(s,o).translate(t,e);if(this.option("zoom")){if(!d){const y=this.targetScale,w=this.minScale,v=this.maxScale;y*i<w&&(i=w/y),y*i>v&&(i=v/y)}m=m.scale(i)}m=m.translate(-s,-o).translate(-c,-g).multiply(b),n&&(m=m.rotate(n)),r&&(m=m.scale(-1,1)),l&&(m=m.scale(1,-1));for(const y of z)y!=="e"&&y!=="f"&&(m[y]>this.minScale+1e-5||m[y]<this.minScale-1e-5)?this.target[y]=m[y]:this.target[y]=f(m[y],1e3);(this.targetScale<this.scale||Math.abs(i-1)>.1||this.panMode==="mousemove"||p===!1)&&!d&&this.clampTargetBounds(),this.isResting||(this.state=P.Panning,this.requestTick())}stop(t=!1){if(this.state===P.Init||this.state===P.Destroy)return;const e=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const i of z)this.velocity[i]=0,t==="current"?this.current[i]=this.target[i]:t==="target"&&(this.target[i]=this.current[i]);this.setTransform(),E(this.container,"is-scaling"),E(this.container,"is-animating"),this.isTicking=!1,this.state=P.Ready,e&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),T(this.container,"is-animating"),this.isScaling&&T(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(t,e=this.option("mouseMoveFriction")){if(this.pmme=t,this.panMode!=="mousemove"||!t||f(this.targetScale)<=f(this.minScale))return;this.emit("mouseMove",t);const{container:i,containerRect:n,contentRect:s}=this,o=n.width,a=n.height,r=i.getBoundingClientRect(),l=(t.clientX||0)-r.left,d=(t.clientY||0)-r.top;let{contentWidth:p,contentHeight:h}=this.calculateContentDim(this.target);const c=this.option("mouseMoveFactor");c>1&&(p!==o&&(p*=c),h!==a&&(h*=c));let g=.5*(p-o)-l/o*100/100*(p-o);g+=.5*(s.right-s.left);let b=.5*(h-a)-d/a*100/100*(h-a);b+=.5*(s.bottom-s.top),this.applyChange({panX:g-this.target.e,panY:b-this.target.f,friction:e})}zoomWithWheel(t){if(this.state===P.Destroy||this.state===P.Init)return;const e=Date.now();if(e-this.pwt<45)return void t.preventDefault();this.pwt=e;var i=[-t.deltaX||0,-t.deltaY||0,-t.detail||0].reduce(function(l,d){return Math.abs(d)>Math.abs(l)?d:l});const n=Math.max(-1,Math.min(1,i)),{targetScale:s,maxScale:o,minScale:a}=this;let r=s*(100+45*n)/100;f(r)<f(a)&&f(s)<=f(a)?(this.cwd+=Math.abs(n),r=a):f(r)>f(o)&&f(s)>=f(o)?(this.cwd+=Math.abs(n),r=o):(this.cwd=0,r=Math.max(Math.min(r,o),a)),this.cwd>this.option("wheelLimit")||(t.preventDefault(),f(r)!==f(s)&&this.zoomTo(r,{event:t}))}canZoomIn(){return this.option("zoom")&&(f(this.contentRect.width,1)<f(this.contentRect.fitWidth,1)||f(this.targetScale)<f(this.maxScale))}canZoomOut(){return this.option("zoom")&&f(this.targetScale)>f(this.minScale)}zoomIn(t=1.25,e){this.zoomTo(this.targetScale*t,e)}zoomOut(t=.8,e){this.zoomTo(this.targetScale*t,e)}zoomToFit(t){this.zoomTo("fit",t)}zoomToCover(t){this.zoomTo("cover",t)}zoomToFull(t){this.zoomTo("full",t)}zoomToMax(t){this.zoomTo("max",t)}toggleZoom(t){this.zoomTo(this.targetScale-this.minScale<.5*(this.fullScale-this.minScale)?"full":"fit",t)}toggleMax(t){this.zoomTo(this.targetScale-this.minScale<.5*(this.maxScale-this.minScale)?"max":"fit",t)}toggleCover(t){this.zoomTo(this.targetScale-this.minScale<.5*(this.coverScale-this.minScale)?"cover":"fit",t)}iterateZoom(t){this.zoomTo("next",t)}zoomTo(t=1,{friction:e="auto",originX:i=0,originY:n=0,event:s}={}){if(this.isContentLoading||this.state===P.Destroy)return;const{targetScale:o}=this;this.stop();let a=1;if(this.panMode==="mousemove"&&(s=this.pmme||s),s){const p=this.content.getBoundingClientRect(),h=s.clientX||0,c=s.clientY||0;i=h-p.left-.5*p.width,n=c-p.top-.5*p.height}const r=this.fullScale,l=this.maxScale;let d=this.coverScale;typeof t=="number"?a=t/o:(t==="next"&&(r-d<.2&&(d=r),t=o<r-1e-5?"full":o<l-1e-5?"max":"fit"),a=t==="full"?r/o||1:t==="cover"?d/o||1:t==="max"?l/o||1:1/o||1),e=e==="auto"?a>1?.15:.25:e,this.applyChange({scale:a,originX:i,originY:n,friction:e}),s&&this.panMode==="mousemove"&&this.panWithMouse(s,e)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:t,contentRect:e,target:i}=this;this.applyChange({panX:.5*t.width-(e.left+.5*e.fitWidth)-i.e,panY:.5*t.height-(e.top+.5*e.fitHeight)-i.f,scale:t.width/e.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:t,contentRect:e,target:i}=this;this.applyChange({panX:.5*t.width-(e.left+.5*e.fitWidth)-i.e,panY:.5*t.innerHeight-(e.top+.5*e.fitHeight)-i.f,scale:t.height/e.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:t}=this,e=this.cn("inFullscreen"),i=this.cn("htmlHasFullscreen");t.classList.toggle(e);const n=t.classList.contains(e);n?(document.documentElement.classList.add(i),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(i),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(n?"enterFS":"exitFS")}getMatrix(t=this.current){const{a:e,b:i,c:n,d:s,e:o,f:a}=t;return new DOMMatrix([e,i,n,s,o,a])}reset(t){if(this.state!==P.Init&&this.state!==P.Destroy){this.stop("current");for(const e of z)this.target[e]=N[e];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=t===void 0?this.option("friction"):t,this.state=P.Panning,this.requestTick())}}destroy(){this.stop(),this.state=P.Destroy,this.detachEvents(),this.detachObserver();const{container:t,content:e}=this,i=this.option("classes")||{};for(const n of Object.values(i))t.classList.remove(n+"");e&&(e.removeEventListener("load",this.onLoad),e.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(j,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:lt}),Object.defineProperty(j,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const tt=function(u,t){let e=!0;return(...i)=>{e&&(e=!1,u(...i),setTimeout(()=>{e=!0},t))}},et=(u,t)=>{let e=[];return u.childNodes.forEach(i=>{i.nodeType!==Node.ELEMENT_NODE||t&&!i.matches(t)||e.push(i)}),e},ht={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var S;(function(u){u[u.Init=0]="Init",u[u.Ready=1]="Ready",u[u.Destroy=2]="Destroy"})(S||(S={}));const W=u=>{if(typeof u=="string"&&(u={html:u}),!(u instanceof String||u instanceof HTMLElement)){const t=u.thumb;t!==void 0&&(typeof t=="string"&&(u.thumbSrc=t),t instanceof HTMLImageElement&&(u.thumbEl=t,u.thumbElSrc=t.src,u.thumbSrc=t.src),delete u.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",index:-1,dim:0,gap:0,pos:0,transition:!1},u)},ct=(u={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},u);class K extends X{constructor(t,e){super(e),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:t})}attach(){}detach(){}}const dt={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class nt extends K{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let t=this.list;return t||(t=document.createElement("ul"),T(t,this.cn("list")),t.setAttribute("role","tablist"),this.instance.container.appendChild(t),T(this.instance.container,this.cn("hasDots")),this.list=t),t}refresh(){var t;const e=this.instance.pages.length,i=Math.min(2,this.option("minCount")),n=Math.max(2e3,this.option("maxCount")),s=this.option("dynamicFrom");if(e<i||e>n)return void this.cleanup();const o=typeof s=="number"&&e>5&&e>=s,a=!this.list||this.isDynamic!==o||this.list.children.length!==e;a&&this.cleanup();const r=this.build();if(k(r,this.cn("isDynamic"),!!o),a)for(let p=0;p<e;p++)r.append(this.createItem(p));let l,d=0;for(const p of[...r.children]){const h=d===this.instance.page;h&&(l=p),k(p,this.cn("isCurrent"),h),(t=p.children[0])===null||t===void 0||t.setAttribute("aria-selected",h?"true":"false");for(const c of["isBeforePrev","isPrev","isNext","isAfterNext"])E(p,this.cn(c));d++}if(l=l||r.firstChild,o&&l){const p=l.previousElementSibling,h=p&&p.previousElementSibling;T(p,this.cn("isPrev")),T(h,this.cn("isBeforePrev"));const c=l.nextElementSibling,g=c&&c.nextElementSibling;T(c,this.cn("isNext")),T(g,this.cn("isAfterNext"))}this.isDynamic=o}createItem(t=0){var e;const i=document.createElement("li");i.setAttribute("role","presentation");const n=G(this.instance.localize(this.option("dotTpl"),[["%d",t+1]]).replace(/\%i/g,t+""));return i.appendChild(n),(e=i.children[0])===null||e===void 0||e.setAttribute("role","tab"),i}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,E(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(nt,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:dt});class ot extends K{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){const t=this.instance,e=t.pages.length,i=t.page;if(e<2)return void this.cleanup();this.build();let n=this.prev,s=this.next;n&&s&&(n.removeAttribute("disabled"),s.removeAttribute("disabled"),t.isInfinite||(i<=0&&n.setAttribute("disabled",""),i>=e-1&&s.setAttribute("disabled","")))}createButton(t){const e=this.instance,i=document.createElement("button");i.setAttribute("tabindex","0"),i.setAttribute("title",e.localize(`{{${t.toUpperCase()}}}`)),T(i,this.cn("button")+" "+this.cn(t==="next"?"isNext":"isPrev"));const n=e.isRTL?t==="next"?"prev":"next":t;var s;return i.innerHTML=e.localize(this.option(`${n}Tpl`)),i.dataset[`carousel${s=t,s?s.match("^[a-z]")?s.charAt(0).toUpperCase()+s.substring(1):s:""}`]="true",i}build(){let t=this.container;t||(this.container=t=document.createElement("div"),T(t,this.cn("container")),this.instance.container.appendChild(t)),this.next||(this.next=t.appendChild(this.createButton("next"))),this.prev||(this.prev=t.appendChild(this.createButton("prev")))}cleanup(){this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove(),this.prev=null,this.next=null,this.container=null}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(ot,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class at extends K{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(t){this.target=this.instance,this.nav=t,this.attachEvents()}addAsNavFor(t){this.nav=this.instance,this.target=t,this.attachEvents()}attachEvents(){this.nav&&this.target&&(this.nav.options.initialSlide=this.target.options.initialPage,this.nav.on("ready",this.onNavReady),this.nav.state===S.Ready&&this.onNavReady(this.nav),this.target.on("ready",this.onTargetReady),this.target.state===S.Ready&&this.onTargetReady(this.target))}onNavReady(t){t.on("createSlide",this.onNavCreateSlide),t.on("Panzoom.click",this.onNavClick),t.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(t){t.on("change",this.onTargetChange),t.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(t,e,i){i.pointerType||this.onNavTouch(t,t.panzoom,i)}onNavTouch(t,e,i){var n,s;if(Math.abs(e.dragOffset.x)>3||Math.abs(e.dragOffset.y)>3)return;const o=i.target,{nav:a,target:r}=this;if(!a||!r||!o)return;const l=o.closest("[data-index]");if(i.stopPropagation(),i.preventDefault(),!l)return;const d=parseInt(l.dataset.index||"",10)||0,p=r.getPageForSlide(d),h=a.getPageForSlide(d);a.slideTo(h),r.slideTo(p,{friction:((s=(n=this.nav)===null||n===void 0?void 0:n.plugins)===null||s===void 0?void 0:s.Sync.option("friction"))||0}),this.markSelectedSlide(d)}onNavCreateSlide(t,e){e.index===this.selectedIndex&&this.markSelectedSlide(e.index)}onTargetChange(){const{target:t,nav:e}=this;if(!t||!e||e.state!==S.Ready||t.state!==S.Ready)return;const i=t.pages[t.page].slides[0].index,n=e.getPageForSlide(i);this.markSelectedSlide(i),e.slideTo(n)}markSelectedSlide(t){const e=this.nav;e&&e.state===S.Ready&&(this.selectedIndex=t,[...e.slides].map(i=>{i.el&&i.el.classList[i.index===t?"add":"remove"]("is-nav-selected")}))}attach(){const t=this;let e=t.options.target,i=t.options.nav;e?t.addAsNavFor(e):i&&t.addAsTargetFor(i)}detach(){const t=this,e=t.nav,i=t.target;e&&(e.off("ready",t.onNavReady),e.off("createSlide",t.onNavCreateSlide),e.off("Panzoom.click",t.onNavClick),e.off("Panzoom.touchEnd",t.onNavTouch)),t.nav=null,i&&(i.off("ready",t.onTargetReady),i.off("refresh",t.onTargetChange),i.off("change",t.onTargetChange)),t.target=null}}Object.defineProperty(at,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const ut={Navigation:ot,Dots:nt,Sync:at};class C extends it{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===S.Ready}get isInfinite(){let t=!1;const{contentDim:e,viewportDim:i,pages:n,slides:s}=this;return n.length>=2&&e+s[0].dim>=i&&(t=this.option("infinite")),t}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(t,e={},i={}){if(super(),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:S.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof t=="string"&&(t=document.querySelector(t)),!t||!H(t))throw new Error("No Element found");this.container=t,this.slideNext=tt(this.slideNext.bind(this),150),this.slidePrev=tt(this.slidePrev.bind(this),150),this.userOptions=e,this.userPlugins=i,queueMicrotask(()=>{this.processOptions()})}processOptions(){const t=B({},C.defaults,this.userOptions);let e="";const i=t.breakpoints;if(i&&_(i))for(const[n,s]of Object.entries(i))window.matchMedia(n).matches&&_(s)&&(e+=n,B(t,s));e===this.bp&&this.state!==S.Init||(this.bp=e,this.state===S.Ready&&(t.initialSlide=this.pages[this.page].slides[0].index),this.state!==S.Init&&this.destroy(),super.setOptions(t),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=S.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},C.Plugins),this.userPlugins)),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=S.Ready,this.emit("ready")}initLayout(){const{container:t}=this,e=this.option("classes");T(t,this.cn("container")),k(t,e.isLTR,!this.isRTL),k(t,e.isRTL,this.isRTL),k(t,e.isVertical,!this.isHorizontal),k(t,e.isHorizontal,this.isHorizontal);let i=this.option("viewport")||t.querySelector(`.${e.viewport}`);i||(i=document.createElement("div"),T(i,e.viewport),i.append(...et(t,`.${e.slide}`)),t.prepend(i));let n=this.option("track")||t.querySelector(`.${e.track}`);n||(n=document.createElement("div"),T(n,e.track),n.append(...Array.from(i.childNodes))),n.setAttribute("aria-live","polite"),i.contains(n)||i.prepend(n),this.viewport=i,this.track=n,this.emit("initLayout")}initSlides(){const{track:t}=this;if(t){this.slides=[],[...et(t,`.${this.cn("slide")}`)].forEach(e=>{if(H(e)){const i=W({el:e,isDom:!0,index:this.slides.length});this.slides.push(i),this.emit("initSlide",i,this.slides.length)}});for(let e of this.option("slides",[])){const i=W(e);i.index=this.slides.length,this.slides.push(i),this.emit("initSlide",i,this.slides.length)}this.emit("initSlides")}}setInitialPage(){let t=0;const e=this.option("initialSlide");t=typeof e=="number"?this.getPageForSlide(e):parseInt(this.option("initialPage",0)+"",10)||0,this.page=t}setInitialPosition(){if(!this.track||!this.pages.length)return;const t=this.isHorizontal;let e=this.page;this.pages[e]||(this.page=e=0);const i=this.pages[e].pos*(this.isRTL&&t?1:-1),n=t?`${i}px`:"0",s=t?"0":`${i}px`;this.track.style.transform=`translate3d(${n}, ${s}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const t=this.option("Panzoom")||{};this.panzoom=new j(this.viewport,B({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:e=>!(this.pages.length<2&&!e.options.infinite),bounds:()=>this.getBounds(),maxVelocity:e=>Math.abs(e.target[this.axis]-e.current[this.axis])<2*this.viewportDim?100:0},t)),this.panzoom.on("*",(e,i,...n)=>{this.emit(`Panzoom.${i}`,e,...n)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const t=this.container;t&&(t.addEventListener("click",this.onClick,{passive:!1,capture:!1}),t.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let t=[];const{contentDim:e,viewportDim:i}=this;let n=this.option("slidesPerPage");(typeof n!="number"||e<=i)&&(n=1/0);let s=0,o=0,a=0;for(const r of this.slides)(!t.length||o+r.dim>i||a===n)&&(t.push(ct()),s=t.length-1,o=0,a=0),t[s].slides.push(r),o+=r.dim+r.gap,a++;return t}processPages(){const t=this.pages,{contentDim:e,viewportDim:i}=this,n=this.option("center"),s=this.option("fill"),o=s&&n&&e>i&&!this.isInfinite;if(t.forEach((l,d)=>{l.index=d,l.pos=l.slides[0].pos,l.dim=0;for(const[p,h]of l.slides.entries())l.dim+=h.dim,p<l.slides.length-1&&(l.dim+=h.gap);o&&l.pos+.5*l.dim<.5*i?l.pos=0:o&&l.pos+.5*l.dim>=e-.5*i?l.pos=e-i:n&&(l.pos+=-.5*(i-l.dim))}),t.forEach((l,d)=>{s&&!this.isInfinite&&e>i&&(l.pos=Math.max(l.pos,0),l.pos=Math.min(l.pos,e-i)),l.pos=f(l.pos,1e3),l.dim=f(l.dim,1e3),l.pos<.1&&l.pos>-.1&&(l.pos=0)}),this.isInfinite)return t;const a=[];let r;return t.forEach(l=>{const d=Object.assign({},l);r&&d.pos===r.pos?(r.dim+=d.dim,r.slides=[...r.slides,...d.slides]):(d.index=a.length,r=d,a.push(d))}),a}getPageFromIndex(t=0){const e=this.pages.length;let i;return t=parseInt((t||0).toString())||0,i=this.isInfinite?(t%e+e)%e:Math.max(Math.min(t,e-1),0),i}getSlideMetrics(t){var e;const i=this.isHorizontal?"width":"height";let n=0,s=0,o=t.el;if(o?n=parseFloat(o.dataset[i]||"")||0:(o=document.createElement("div"),o.style.visibility="hidden",T(o,this.cn("slide")+" "+t.class),(this.track||document.body).prepend(o)),n)o.style[i]=`${n}px`,o.style[i==="width"?"height":"width"]="";else{const r=Math.max(1,((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1);n=o.getBoundingClientRect()[i]*r}const a=getComputedStyle(o);return a.boxSizing==="content-box"&&(this.isHorizontal?(n+=parseFloat(a.paddingLeft)||0,n+=parseFloat(a.paddingRight)||0):(n+=parseFloat(a.paddingTop)||0,n+=parseFloat(a.paddingBottom)||0)),s=parseFloat(a[this.isHorizontal?"marginRight":"marginBottom"])||0,t.el||o.remove(),{dim:f(n,1e3),gap:f(s,1e3)}}getBounds(){const{isInfinite:t,isRTL:e,isHorizontal:i,pages:n}=this;let s={min:0,max:0};if(t)s={min:-1/0,max:1/0};else if(n.length){const o=n[0].pos,a=n[n.length-1].pos;s=e&&i?{min:o,max:a}:{min:-1*a,max:-1*o}}return{x:i?s:{min:0,max:0},y:i?{min:0,max:0}:s}}repositionSlides(){let t,{isHorizontal:e,isRTL:i,isInfinite:n,viewport:s,viewportDim:o,contentDim:a,page:r,pages:l,slides:d,panzoom:p}=this,h=0,c=0,g=0,b=0;p?b=-1*p.current[this.axis]:l[r]&&(b=l[r].pos||0),t=e?i?"right":"left":"top",i&&e&&(b*=-1);for(const v of d)v.el?(t==="top"?(v.el.style.right="",v.el.style.left=""):v.el.style.top="",v.index!==h?v.el.style[t]=c===0?"":`${f(c,1e3)}px`:v.el.style[t]="",g+=v.dim+v.gap,h++):c+=v.dim+v.gap;if(n&&g&&s){let v=getComputedStyle(s),M="padding",R=e?"Right":"Bottom",L=parseFloat(v[M+(e?"Left":"Top")]);b-=L,o+=L,o+=parseFloat(v[M+R]);for(const x of d)x.el&&(f(x.pos)<f(o)&&f(x.pos+x.dim+x.gap)<f(b)&&f(b)>f(a-o)&&(x.el.style[t]=`${f(c+g,1e3)}px`),f(x.pos+x.gap)>=f(a-o)&&f(x.pos)>f(b+o)&&f(b)<f(o)&&(x.el.style[t]=`-${f(g,1e3)}px`))}let m,y,w=[...this.inTransition];if(w.length>1&&(m=l[w[0]],y=l[w[1]]),m&&y){let v=0;for(const M of d)M.el?this.inTransition.has(M.index)&&m.slides.indexOf(M)<0&&(M.el.style[t]=`${f(v+(m.pos-y.pos),1e3)}px`):v+=M.dim+M.gap}}createSlideEl(t){const{track:e,slides:i}=this;if(!e||!t||t.el)return;const n=document.createElement("div");T(n,this.cn("slide")),T(n,t.class),T(n,t.customClass),t.html&&(n.innerHTML=t.html);const s=[];i.forEach((l,d)=>{l.el&&s.push(d)});const o=t.index;let a=null;s.length&&(a=i[s.reduce((l,d)=>Math.abs(d-o)<Math.abs(l-o)?d:l)]);const r=a&&a.el?a.index<t.index?a.el.nextSibling:a.el:null;e.insertBefore(n,e.contains(r)?r:null),t.el=n,this.emit("createSlide",t)}removeSlideEl(t,e=!1){const i=t.el;if(!i)return;if(E(i,this.cn("isSelected")),t.isDom&&!e)return i.removeAttribute("aria-hidden"),i.removeAttribute("data-index"),E(i,this.cn("isSelected")),void(i.style.left="");this.emit("removeSlide",t);const n=new CustomEvent("animationend");i.dispatchEvent(n),t.el&&t.el.remove(),t.el=null}transitionTo(t=0,e=this.option("transition")){if(!e)return!1;const{pages:i,panzoom:n}=this;t=parseInt((t||0).toString())||0;const s=this.getPageFromIndex(t);if(!n||!i[s]||i.length<2||Math.abs(i[this.page].slides[0].dim-this.viewportDim)>1)return!1;const o=t>this.page?1:-1,a=this.pages[s].pos*(this.isRTL?1:-1);if(this.page===s&&f(a,1e3)===f(n.target[this.axis],1e3))return!1;this.clearTransitions();const r=n.isResting;T(this.container,this.cn("inTransition"));const l=this.pages[this.page].slides[0],d=this.pages[s].slides[0];this.inTransition.add(d.index),this.createSlideEl(d);let p=l.el,h=d.el;r||e==="slide"||(e="fadeFast",p=null);const c=this.isRTL?"next":"prev",g=this.isRTL?"prev":"next";return p&&(this.inTransition.add(l.index),l.transition=e,p.addEventListener("animationend",this.onAnimationEnd),p.classList.add(`f-${e}Out`,`to-${o>0?g:c}`)),h&&(d.transition=e,h.addEventListener("animationend",this.onAnimationEnd),h.classList.add(`f-${e}In`,`from-${o>0?c:g}`)),n.panTo({x:this.isHorizontal?a:0,y:this.isHorizontal?0:a,friction:0}),this.onChange(s),!0}manageSlideVisiblity(){const t=new Set,e=new Set,i=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const n of this.slides)i.has(n)?t.add(n):e.add(n);for(const n of this.inTransition)t.add(this.slides[n]);for(const n of t)this.createSlideEl(n),this.lazyLoadSlide(n);for(const n of e)t.has(n)||this.removeSlideEl(n);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const t="aria-hidden";let e=this.cn("isSelected");if(e)for(const i of this.slides)i.el&&(i.el.dataset.index=`${i.index}`,this.pages[this.page].slides.includes(i)?(i.el.classList.contains(e)||(T(i.el,e),this.emit("selectSlide",i)),i.el.removeAttribute(t)):(i.el.classList.contains(e)&&(E(i.el,e),this.emit("unselectSlide",i)),i.el.setAttribute(t,"true")))}flipInfiniteTrack(){const t=this.panzoom;if(!t||!this.isInfinite)return;const e=this.option("axis")==="x"?"e":"f",{viewportDim:i,contentDim:n}=this;let s=t.current[e],o=t.target[e]-s,a=0,r=.5*i,l=n;this.isRTL&&this.isHorizontal?(s<-r&&(a=-1,s+=l),s>l-r&&(a=1,s-=l)):(s>r&&(a=1,s-=l),s<-l+r&&(a=-1,s+=l)),a&&(t.current[e]=s,t.target[e]=s+o)}lazyLoadSlide(t){const e=this,i=t&&t.el;if(!i)return;const n=new Set,s="f-fadeIn";i.querySelectorAll("[data-lazy-srcset]").forEach(r=>{r instanceof HTMLImageElement&&n.add(r)});let o=Array.from(i.querySelectorAll("[data-lazy-src]"));i.dataset.lazySrc&&o.push(i),o.map(r=>{r instanceof HTMLImageElement?n.add(r):H(r)&&(r.style.backgroundImage=`url('${r.dataset.lazySrc||""}')`,delete r.dataset.lazySrc)});const a=(r,l,d)=>{d&&(d.remove(),d=null),l.complete&&(l.classList.add(s),setTimeout(()=>{l.classList.remove(s)},350),l.style.display=""),this.option("adaptiveHeight")&&r.el&&this.pages[this.page].slides.indexOf(r)>-1&&(e.updateMetrics(),e.setViewportHeight()),this.emit("load",r)};for(const r of n){let l=null;r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.style.display="none",r.addEventListener("error",()=>{a(t,r,l)}),r.addEventListener("load",()=>{a(t,r,l)}),setTimeout(()=>{r.parentNode&&t.el&&(r.complete?a(t,r,l):(l=G(st),r.parentNode.insertBefore(l,r)))},300)}}onAnimationEnd(t){var e;const i=t.target,n=i?parseInt(i.dataset.index||"",10)||0:-1,s=this.slides[n],o=t.animationName;if(!i||!s||!o)return;const a=!!this.inTransition.has(n)&&s.transition;a&&o.substring(0,a.length+2)===`f-${a}`&&this.inTransition.delete(n),this.inTransition.size||this.clearTransitions(),n===this.page&&(!((e=this.panzoom)===null||e===void 0)&&e.isResting)&&this.emit("settle")}onDecel(t,e=0,i=0,n=0,s=0){const{isRTL:o,isHorizontal:a,axis:r,pages:l}=this,d=l.length,p=Math.abs(Math.atan2(i,e)/(Math.PI/180));let h=0;if(h=p>45&&p<135?a?0:i:a?e:0,!d)return;const c=this.option("dragFree");let g=this.page,b=o&&a?1:-1;const m=t.target[r]*b,y=t.current[r]*b;let{pageIndex:w}=this.getPageFromPosition(m),{pageIndex:v}=this.getPageFromPosition(y);c?this.onChange(w):(Math.abs(h)>5?(l[g].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(g=v),g=o&&a?h<0?g-1:g+1:h<0?g+1:g-1):g=n===0&&s===0?g:v,this.slideTo(g,{transition:!1,friction:t.option("decelFriction")}))}onClick(t){const e=t.target,i=e&&H(e)?e.dataset:null;let n,s;i&&(i.carouselPage!==void 0?(s="slideTo",n=i.carouselPage):i.carouselNext!==void 0?s="slideNext":i.carouselPrev!==void 0&&(s="slidePrev")),s?(t.preventDefault(),t.stopPropagation(),e&&!e.hasAttribute("disabled")&&this[s](n)):this.emit("click",t)}onSlideTo(t){const e=t.detail||0;this.slideTo(this.getPageForSlide(e),{friction:0})}onChange(t,e=0){const i=this.page;this.prevPage=i,this.page=t,this.option("adaptiveHeight")&&this.setViewportHeight(),t!==i&&(this.markSelectedSlides(),this.emit("change",t,i,e))}onRefresh(){let t=this.contentDim,e=this.viewportDim;this.updateMetrics(),this.contentDim===t&&this.viewportDim===e||this.slideTo(this.page,{friction:0,transition:!1})}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(t){this.lp!==t.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=t.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(t=null,e=null){this.destroy(),this.state=S.Init,this.userOptions=t||this.userOptions,this.userPlugins=e||this.userPlugins,this.processOptions()}slideTo(t=0,{friction:e=this.option("friction"),transition:i=this.option("transition")}={}){if(this.state===S.Destroy)return;const{axis:n,isHorizontal:s,isRTL:o,pages:a,panzoom:r}=this,l=a.length,d=o&&s?1:-1;if(!r||!l||this.transitionTo(t,i))return;const p=this.getPageFromIndex(t);let h=a[p].pos;if(this.isInfinite){const c=this.contentDim,g=r.target[n]*d;if(l===2)h+=c*Math.floor(parseFloat(t+"")/2);else{const b=g;h=[h,h-c,h+c].reduce(function(m,y){return Math.abs(y-b)<Math.abs(m-b)?y:m})}}h*=d,Math.abs(r.target[n]-h)<.1||(r.panTo({x:s?h:0,y:s?0:h,friction:e}),this.onChange(p))}slideToClosest(t){if(this.panzoom){const{pageIndex:e}=this.getPageFromPosition(this.panzoom.current[this.isHorizontal?"e":"f"]);this.slideTo(e,t)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),E(this.container,this.cn("inTransition"));const t=["to-prev","to-next","from-prev","from-next"];for(const e of this.slides){const i=e.el;if(i){i.removeEventListener("animationend",this.onAnimationEnd),i.classList.remove(...t);const n=e.transition;n&&i.classList.remove(`f-${n}Out`,`f-${n}In`)}}this.manageSlideVisiblity()}prependSlide(t){var e,i;let n=Array.isArray(t)?t:[t];for(const a of n.reverse())this.slides.unshift(W(a));for(let a=0;a<this.slides.length;a++)this.slides[a].index=a;const s=((e=this.pages[this.page])===null||e===void 0?void 0:e.pos)||0;this.page+=n.length,this.updateMetrics();const o=((i=this.pages[this.page])===null||i===void 0?void 0:i.pos)||0;if(this.panzoom){const a=this.isRTL?s-o:o-s;this.panzoom.target.e-=a,this.panzoom.current.e-=a,this.panzoom.requestTick()}}appendSlide(t){let e=Array.isArray(t)?t:[t];for(const i of e){const n=W(i);n.index=this.slides.length,this.slides.push(n),this.emit("initSlide",i,this.slides.length)}this.updateMetrics()}removeSlide(t){const e=this.slides.length;t=(t%e+e)%e,this.removeSlideEl(this.slides[t],!0),this.slides.splice(t,1);for(let i=0;i<this.slides.length;i++)this.slides[i].index=i;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1})}updateMetrics(){const{panzoom:t,viewport:e,track:i,isHorizontal:n}=this;if(!i)return;const s=n?"width":"height",o=n?"offsetWidth":"offsetHeight";if(e){let p=Math.max(e[o],f(e.getBoundingClientRect()[s],1e3)),h=getComputedStyle(e),c="padding",g=n?"Right":"Bottom";p-=parseFloat(h[c+(n?"Left":"Top")])+parseFloat(h[c+g]),this.viewportDim=p}let a,r=this.pages.length,l=0;for(const[p,h]of this.slides.entries()){let c=0,g=0;!h.el&&a?(c=a.dim,g=a.gap):({dim:c,gap:g}=this.getSlideMetrics(h),a=h),c=f(c,1e3),g=f(g,1e3),h.dim=c,h.gap=g,h.pos=l,l+=c,(this.isInfinite||p<this.slides.length-1)&&(l+=g)}const d=this.contentDim;l=f(l,1e3),this.contentDim=l,t&&(t.contentRect[s]=l,t.contentRect[this.axis==="e"?"fullWidth":"fullHeight"]=l),this.pages=this.createPages(),this.pages=this.processPages(),this.state===S.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),t&&r===this.pages.length&&Math.abs(l-d)>.5&&(t.target[this.axis]=-1*this.pages[this.page].pos,t.current[this.axis]=-1*this.pages[this.page].pos,t.stop()),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(t,e=!1){t===void 0&&(t=this.page);const i=this,n=i.panzoom,s=i.pages[t]||0;if(!s||!n)return 0;let o=-1*n.current.e,a=i.contentDim;var r=[f((o-s.pos)/(1*s.dim),1e3),f((o+a-s.pos)/(1*s.dim),1e3),f((o-a-s.pos)/(1*s.dim),1e3)].reduce(function(l,d){return Math.abs(d)<Math.abs(l)?d:l});return e?r:Math.max(-1,Math.min(1,r))}setViewportHeight(){const{page:t,pages:e,viewport:i,isHorizontal:n}=this;if(!i||!e[t])return;let s=0;n&&this.track&&(this.track.style.height="auto",e[t].slides.forEach(o=>{o.el&&(s=Math.max(s,o.el.offsetHeight))})),i.style.height=s?`${s}px`:""}getPageForSlide(t){for(const e of this.pages)for(const i of e.slides)if(i.index===t)return e.index;return-1}getVisibleSlides(t=0){var e;const i=new Set;let{contentDim:n,viewportDim:s,pages:o,page:a}=this;n=n+((e=this.slides[this.slides.length-1])===null||e===void 0?void 0:e.gap)||0;let r=0;r=this.panzoom?-1*this.panzoom.current[this.axis]:o[a]&&o[a].pos||0,this.isInfinite&&(r-=Math.floor(r/n)*n),this.isRTL&&this.isHorizontal&&(r*=-1);const l=r-s*t,d=r+s*(t+1),p=this.isInfinite?[-1,0,1]:[0];for(const h of this.slides)for(const c of p){const g=h.pos+c*n,b=h.pos+h.dim+h.gap+c*n;g<d&&b>l&&i.add(h)}return i}getPageFromPosition(t){const{viewportDim:e,contentDim:i}=this,n=this.pages.length,s=this.slides.length,o=this.slides[s-1];let a=0,r=0,l=0;const d=this.option("center");d&&(t+=.5*e),this.isInfinite||(t=Math.max(this.slides[0].pos,Math.min(t,o.pos)));const p=i+o.gap;l=Math.floor(t/p)||0,t-=l*p;let h=o,c=this.slides.find(g=>{const b=t+(h&&!d?.5*h.dim:0);return h=g,g.pos<=b&&g.pos+g.dim+g.gap>b});return c||(c=o),r=this.getPageForSlide(c.index),a=r+l*n,{page:a,pageIndex:r}}destroy(){if([S.Destroy].includes(this.state))return;this.state=S.Destroy;const{container:t,viewport:e,track:i,slides:n,panzoom:s}=this,o=this.option("classes");t.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),t.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),s&&(s.destroy(),this.panzoom=null),n&&n.forEach(r=>{this.removeSlideEl(r)}),this.detachPlugins(),e&&e.offsetParent&&i&&i.offsetParent&&e.replaceWith(...i.childNodes);for(const[r,l]of Object.entries(o))r!=="container"&&l&&t.classList.remove(l);this.track=null,this.viewport=null,this.page=0,this.slides=[];const a=this.events.get("ready");this.events=new Map,a&&this.events.set("ready",a)}}Object.defineProperty(C,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:j}),Object.defineProperty(C,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:ht}),Object.defineProperty(C,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:ut});export{C as H};